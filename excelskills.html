<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Excel Portfolio</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Tailwind configuration for custom colors (Excel green and blue)
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Light background color for the header
                        'excel-blue': '#f0f2f5', 
                        // Dark green for text and primary accents (Intermediate level)
                        'excel-green': '#107C41',
                        // Custom colors for skill levels
                        'basic-yellow': '#FBBF24', // Yellow 500
                        'adv-orange': '#F97316',   // Orange 600
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <!-- Custom CSS for the essential iframe dimensions and link styles -->
    <style>
        /* Sets the critical height and ensures responsiveness */
        #excel-viewer {
            width: 100%;
            height: 700px; /* Recommended height for spreadsheet viewing */
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            transition: all 0.3s ease-in-out;
        }

        /* Styling for the active project button */
        .project-button.active {
            background-color: #107C41; 
            color: white;
            font-weight: 600;
        }
        
        /* Specific styling for the project buttons under the new structure */
        .project-button {
            display: block;
            padding: 8px 12px;
            margin-top: 4px;
            font-size: 0.9rem;
            border-radius: 0.375rem;
            transition: background-color 0.2s, transform 0.1s;
            cursor: pointer;
            text-align: left;
        }
        .project-button:hover {
            background-color: #f3f4f6;
            transform: translateY(-1px);
        }
        
        /* Disabled/Placeholder project button style */
        .project-button.disabled-placeholder {
            opacity: 0.5;
            cursor: default;
        }
        .project-button.disabled-placeholder:hover {
            background-color: transparent;
            transform: none;
        }
        
        /* Tab styling */
        .tab-button {
            padding: 10px 18px;
            font-weight: 500;
            border-bottom: 2px solid transparent;
            transition: color 0.2s, border-color 0.2s;
            cursor: pointer;
            color: #4b5563; /* Gray 600 */
        }
        .tab-button:hover {
            border-color: #e5e7eb; /* Gray 200 */
            color: #111827; /* Gray 900 */
        }
        .tab-button.active-tab {
            border-color: #107C41; /* excel-green */
            color: #107C41; /* excel-green */
            font-weight: 600;
        }

        /* Footer styling */
        .footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid #ddd;
        }
        .footer h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        .footer p {
            margin-bottom: 0.5rem;
            color: #4b5563;
        }
        .footer ul {
            list-style-type: none;
            padding: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 1rem;
        }
        .footer ul li a {
            color: #2874a6;
            font-weight: bold;
            transition: color 0.3s;
        }
        .footer ul li a:hover {
            color: #1e40af;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">

    <!-- Header Section - Contrast fixed and made relative for the absolute home link -->
    <header class="bg-excel-blue text-excel-green text-center p-8 shadow-xl relative">
        <!-- Home Link -->
        <a href="https://meryemciftcialy.github.io/work_sample/" target="_self" 
           class="absolute top-4 left-4 sm:top-6 sm:left-6 
                  px-4 py-2 bg-excel-green text-white rounded-lg 
                  text-base font-semibold shadow-lg hover:opacity-90 
                  transition duration-150 flex items-center z-10">
            <span class="text-xl mr-2">&#x2190;</span> Back to Main Site
        </a>
        <h1 class="text-4xl font-bold mb-2"> Interactive Excel Skills Showcase </h1>
        <p class="text-xl opacity-90">Welcome! Select a project below to see an interactive example and the mixed skill set used.</p>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-6xl mx-auto p-4 sm:p-6 lg:p-8 mt-6 bg-white rounded-xl shadow-2xl">
        
        <!-- Under Development Message (UPDATED) -->
        <div class="p-4 sm:p-6 mb-8 bg-yellow-50 border-l-4 border-yellow-500 rounded-r-lg shadow-md transition duration-500" role="alert">
            <p class="text-xl font-semibold text-yellow-800 flex items-center">
                <svg class="w-6 h-6 mr-3 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                Notice: Project Status
            </p>
            <p class="mt-2 text-gray-700">
                This portfolio is an **ongoing section** to showcase diverse Excel skills. Please note:
                <ul class="list-disc list-inside mt-2 ml-4 space-y-1">
                    <li>For projects listed as **"Not yet added"**, the files are currently in development.</li>
                    <li>If you experience loading issues on **Project 1** or **Project 3** (or other live projects), it is likely due to OneDrive/SharePoint security policies (`X-Frame-Options`). Ensure you are using the exact **"Embed" URL** for those live files.</li>
                </ul>
            </p>
        </div>

        <hr class="border-gray-300 my-8">

        <!-- Hybrid Table of Contents (TOC) Navigation by Skill Level -->
        <section id="toc" class="mb-8">
            <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Interactive Project Portfolio by Skill Level</h2>
            
            <div id="project-navigation-grid" class="grid md:grid-cols-3 gap-6">
                <!-- Navigation links will be dynamically injected here by the script -->
            </div>
        </section>

        <hr class="border-gray-300 my-8">

        <!-- Project View Area (where the spreadsheet embeds and skills are listed) -->
        <section id="project-display">
            
            <!-- Skills Breakdown Section -->
            <div id="skills-breakdown" class="p-4 bg-gray-100 rounded-lg shadow-inner mb-6 transition duration-300 ease-in-out hidden">
                <h3 class="text-xl font-bold text-gray-700 mb-3 border-b pb-2">Skills Demonstrated in Project: <span id="project-title-display" class="text-excel-green"></span></h3>
                <h4 class="text-lg font-semibold text-gray-600 mb-2">Mixed Formulas and Techniques Used:</h4>
                <!-- The skills list content will be generated here -->
                <div id="skills-list">
                    <!-- Structured skills content will be dynamically injected here -->
                </div>
            </div>

            <!-- New: File Selector Tabs -->
            <div id="file-tabs-container" class="mb-6 hidden">
                <h4 class="text-lg font-semibold text-gray-700 mb-2">Select File Version:</h4>
                <nav id="file-tabs" class="-mb-px flex space-x-2 sm:space-x-8" aria-label="Tabs">
                    <!-- Tab Buttons will be dynamically generated and loaded here -->
                </nav>
            </div>

            <!-- Single IFRAME Container -->
            <div class="excel-embed-container rounded-xl overflow-hidden shadow-xl">
                <!-- Initial Message -->
                <p id="initial-message" class="text-center p-12 text-lg text-gray-500 border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 transition duration-500 block">
                    Please select a project from the navigation above to load and interact with the Excel project.
                </p>
                <!-- 
                    The single IFRAME element that will have its source dynamically updated by JavaScript.
                -->
                <iframe id="excel-viewer" src="" allowfullscreen class="hidden"></iframe>
            </div>
        </section>
    </main>

    <!-- Footer Section -->
    <div class="footer">
        <h2>ðŸ“¬ Contact Me</h2>
        <p>Feel free to reach out if youâ€™d like a copy of my resume or just want to connect!</p>
        <ul>
            <li><a href="mailto:meryemkciftci@gmail.com">Email</a></li>
            <li><a href="https://linkedin.com/in/meryack" target="_blank">LinkedIn</a></li>
            <li><a href="https://meryemciftcialy.github.io/work_sample/about_me.html">About Me</a></li>
        </ul>
        <p class="note text-sm text-excel-green font-semibold">Currently open to work opportunities.</p>
        <p class="note2 text-xs text-gray-400">Last updated: September 2025. Check back for new additions!</p>
    </div>


    <!-- JavaScript for Interactivity and Dynamic Content Generation -->
    <script>
        // NOTE: To fix the "refused to connect" error, ensure that all URLs here are the official
        // "Embed" link generated by OneDrive/SharePoint, not a standard "share" link.
        // Look for the option: File -> Share -> Embed.
        const projectData = {
            'Basic': {
                color: 'basic-yellow',
                projects: [
                    { 
                        name: "Project 1: Data Formalization", 
                        urls: {
                            project: "https://1drv.ms/x/c/3cd1fbe75ad01d30/IQR4I0khGrXPQYZznrrEZCdIAVkPK-Ou4K4c6gytX-AxAqI", 
                            clean: "https://1drv.ms/x/c/3cd1fbe75ad01d30/IQTZWBk56lJLSKvkj5zyad3AAScAcPQh7B0P9GdKcCQNnxc", 
                            raw: "https://1drv.ms/x/c/3cd1fbe75ad01d30/IQQ0qVoakaHPSaGXweet4Sb2AXNc6zPSk1yeHqpuKj1VhEQ" 
                        },
                        skills: [
                            { category: "Data Cleaning & Transformation", techniques: [{ name: "SUBSTITUTE()" }, { name: "TRIM()" }, { name: "LEN()" }, { name: "PROPER() / UPPER() / LOWER()" }] },
                            { category: "Data Analysis & Aggregation", techniques: [{ name: "SUMIF()" }, { name: "COUNTIF()" }, { name: "IF()" }] },
                            { category: "Data Exploration & Visualization", techniques: [{ name: "Pivot Tables" }, { name: "Pivot Filters & Sorting" }, { name: "Table Formatting & Structured References" }] },
                            { category: "Data Validation & Consistency Checks", techniques: [{ name: "Conditional Formatting" }, { name: "Text Data Type Verification" }, { name: "Removing Extra Spaces" }] }
                        ],
                        isPlaceholder: false
                    }
                    // Project 2 (Monthly Budget Tracker) has been removed as requested.
                ]
            },
            'Intermediate': {
                color: 'excel-green',
                projects: [
                    { 
                        name: "Project 3: Customer Information Lookup", 
                        urls: {
                            project: "https://1drv.ms/x/c/3cd1fbe75ad01d30/IQRusDRSvZp4SK1IAVJHLYeiAc4IB7EN4cxLmi1qxOmWWds", 
                            // Placeholder URLs for clean/raw files (using the structure of the Advanced placeholder for consistency)
                            clean: "https://onedrive.live.com/embed?resid=Placeholder-P3-Clean", 
                            raw: "https://onedrive.live.com/embed?resid=Placeholder-P3-Raw" 
                        },
                        skills: [
                            { category: "Data Lookup & Retrieval", techniques: [{ name: "VLOOKUP()" }] },
                            { category: "Logical Branching & Conditional Checks", techniques: [{ name: "IF()" }, { name: "OR()" }] },
                            { category: "Data Validation & Type Handling", techniques: [{ name: "ISNUMBER()" }] },
                            { category: "Data Cleaning & Formalization", techniques: [{ name: "UPPER()" }] }
                        ],
                        isPlaceholder: false
                    }
                    // Project 4 (HR Payroll Calculator) has been removed as requested.
                ]
            },
            'Advanced': {
                color: 'adv-orange',
                projects: [
                    { 
                        name: "Project 5: Not yet added", 
                        urls: { 
                            project: "", // Empty URL triggers placeholder message in JS
                            clean: "", 
                            raw: "" 
                        },
                        skills: [
                            { 
                                category: "Advanced Techniques", 
                                techniques: [
                                    { name: "INDEX/MATCH/MATCH" }, 
                                    { name: "Dynamic Arrays (FILTER, SORT)" }, 
                                    { name: "VBA/Macros" }
                                ]
                            }
                        ],
                        isPlaceholder: true
                    }
                    // Project 6 (Automated Report Prep) has been removed as requested.
                ]
            }
        };

        // Data for the tab buttons, mapping a display name to the key in the 'urls' object
        const tabMappings = [
            { key: 'project', label: 'Project Workbook (Final)' },
            { key: 'clean', label: 'Clean Data File' },
            { key: 'raw', label: 'Raw Data File' },
        ];


        document.addEventListener('DOMContentLoaded', () => {
            const excelViewer = document.getElementById('excel-viewer');
            const initialMessage = document.getElementById('initial-message');
            const navGrid = document.getElementById('project-navigation-grid');
            const skillsBreakdown = document.getElementById('skills-breakdown');
            const skillsList = document.getElementById('skills-list');
            const projectTitleDisplay = document.getElementById('project-title-display');
            const fileTabsContainer = document.getElementById('file-tabs-container');
            const fileTabs = document.getElementById('file-tabs');
            
            // Variable to hold the URLs for the currently selected project
            let currentProjectUrls = {};
            
            /**
             * Handles the click event on a file selector tab.
             */
            function handleTabClick(event) {
                event.preventDefault();
                const button = event.currentTarget;
                const fileType = button.dataset.fileType; // e.g., 'raw', 'clean', 'project'
                
                // Set the iframe source to the selected URL
                if (currentProjectUrls[fileType]) {
                    excelViewer.src = currentProjectUrls[fileType];
                }

                // Update active tab styling
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.classList.remove('active-tab');
                });
                button.classList.add('active-tab');
            }
            
            /**
             * Dynamically creates and attaches the file selector tabs.
             */
            function renderFileTabs(urls) {
                fileTabs.innerHTML = '';
                currentProjectUrls = urls; // Store the new URLs globally

                tabMappings.forEach(mapping => {
                    const button = document.createElement('button');
                    button.textContent = mapping.label;
                    button.className = 'tab-button text-sm';
                    button.dataset.fileType = mapping.key;
                    
                    button.addEventListener('click', handleTabClick);
                    fileTabs.appendChild(button);
                    
                    // Disable tabs if the URL is a placeholder/empty
                    const fileUrl = urls[mapping.key];
                    if (!fileUrl || fileUrl.includes('Placeholder')) {
                         button.disabled = true;
                         button.classList.add('opacity-50', 'cursor-not-allowed');
                         button.title = "File not yet prepared for viewing";
                    } else {
                        button.disabled = false;
                        button.classList.remove('opacity-50', 'cursor-not-allowed');
                        button.title = "";
                    }
                });
            }

            /**
             * Handles the click event on a project button.
             */
            function handleProjectClick(event) {
                event.preventDefault();

                // 1. Get data from the button (now stored in dataset)
                const button = event.currentTarget;
                const projectName = button.dataset.name;
                const skills = JSON.parse(button.dataset.skills);
                const urls = JSON.parse(button.dataset.urls); 
                const isPlaceholder = button.dataset.isPlaceholder === 'true';

                // 2. Handle Placeholder Projects
                if (isPlaceholder || !urls.project || urls.project.includes('Placeholder')) {
                    excelViewer.src = "";
                    initialMessage.innerHTML = `
                        <p class="text-center p-12 text-2xl font-semibold text-adv-orange">
                            ${projectName}
                        </p>
                        <p class="text-center p-4 text-lg text-gray-700">
                            This project is currently in development.
                        </p>
                        <div class="max-w-md mx-auto p-4 bg-yellow-50 rounded-lg shadow-inner mt-4">
                            <h5 class="font-semibold text-gray-800 mb-2">Planned Content:</h5>
                            <ul class="list-disc list-inside text-gray-600 space-y-1 text-sm">
                                ${skills[0].techniques.map(t => `<li>${t.name}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                    initialMessage.classList.remove('hidden');
                    excelViewer.classList.add('hidden');
                    fileTabsContainer.classList.add('hidden');
                    skillsBreakdown.classList.add('hidden');
                    
                } else {
                    // 2. Live Project Logic
                    excelViewer.src = urls.project;
                    initialMessage.classList.add('hidden');
                    excelViewer.classList.remove('hidden');
                    fileTabsContainer.classList.remove('hidden');
                    skillsBreakdown.classList.remove('hidden'); 
                    
                    // 5. Render Tabs and set default active tab
                    renderFileTabs(urls);
                    
                    // Manually set the Project Workbook tab as active initially
                    const defaultTab = fileTabs.querySelector('[data-file-type="project"]');
                    if (defaultTab) {
                        defaultTab.classList.add('active-tab');
                    }
                }
                
                // 3. Highlight the active project button
                document.querySelectorAll('.project-button').forEach(btn => {
                    btn.classList.remove('active');
                    btn.classList.remove('text-white');
                    btn.classList.add('text-gray-700');
                });
                // Only mark as active if it's not the disabled placeholder (which should be handled in CSS)
                if (!isPlaceholder) {
                    button.classList.add('active');
                    button.classList.remove('text-gray-700');
                    button.classList.add('text-white');
                }
                
                // 4. Update Skills Breakdown Section (MODIFIED FOR SIMPLE TABLE-LIKE GRID)
                projectTitleDisplay.textContent = projectName;
                skillsList.innerHTML = ''; // Clear previous skills

                // Check if skills data is in the new structured format (array of objects with category)
                if (skills && skills.length > 0 && typeof skills[0] === 'object' && skills[0].category) {
                    // Structured Skills Rendering (Using a lightweight, table-like grid)
                    
                    const introText = document.createElement('p');
                    introText.className = 'text-base font-medium text-gray-700 mb-4 border-b border-gray-300 pb-2';
                    introText.textContent = 'This workbook utilizes the following key formulas and techniques:';
                    skillsList.appendChild(introText);

                    const gridContainer = document.createElement('div');
                    // Responsive grid layout for a non-overpowering table look
                    gridContainer.className = 'grid sm:grid-cols-2 lg:grid-cols-4 gap-4 text-sm'; 
                    skillsList.appendChild(gridContainer);
                    
                    skills.forEach(categoryData => {
                        // Create the category block (acting like a table column/section)
                        const categoryBlock = document.createElement('div');
                        categoryBlock.className = 'p-3 bg-white rounded-lg border border-gray-200 shadow-sm transition duration-150 hover:shadow-md';
                        
                        // Category Title - acting as the column header
                        const categoryTitle = document.createElement('h5');
                        categoryTitle.className = 'font-bold text-gray-800 mb-2 border-b pb-1 text-excel-green';
                        categoryTitle.textContent = categoryData.category;
                        categoryBlock.appendChild(categoryTitle);

                        // List of techniques - acting as the rows
                        const techniquesList = document.createElement('ul');
                        // Use a custom list style to make the text clean
                        techniquesList.className = 'list-none space-y-1 pl-0'; 
                        
                        categoryData.techniques.forEach(technique => {
                            const listItem = document.createElement('li');
                            listItem.className = 'text-gray-700';
                            listItem.textContent = technique.name; 
                            techniquesList.appendChild(listItem);
                        });
                        
                        categoryBlock.appendChild(techniquesList);
                        gridContainer.appendChild(categoryBlock);
                    });

                } else {
                    // Legacy/Placeholder Skills Rendering (Simple Tags - used for non-structured data)
                    const techniquesContainer = document.createElement('div');
                    techniquesContainer.className = 'flex flex-wrap gap-2 mb-4';
                    
                    // Simple text display for unstructured skills
                    const placeholderText = document.createElement('p');
                    placeholderText.className = 'text-gray-600 italic';
                    placeholderText.textContent = skills.join(' '); 
                    skillsList.appendChild(placeholderText);
                }
                
                // 6. Optional: Scroll down to the project view section for better UX on mobile
                document.getElementById('project-display').scrollIntoView({ behavior: 'smooth' });
            }
            
            /**
             * Dynamically generates the navigation structure based on projectData.
             */
            function generateNavigation() {
                navGrid.innerHTML = ''; // Clear existing content

                Object.keys(projectData).forEach(level => {
                    const levelData = projectData[level];
                    const levelColor = levelData.color;
                    
                    // Create the level container
                    const levelDiv = document.createElement('div');
                    levelDiv.className = `p-4 rounded-xl shadow-lg border border-gray-200 bg-${levelColor.replace('-500', '-100/50').replace('-600', '-100/50')}`;
                    
                    // Level Header with colored circle
                    levelDiv.innerHTML = `
                        <h3 class="text-xl font-bold mb-4 flex items-center text-gray-800">
                            <span class="w-4 h-4 rounded-full bg-${levelColor} mr-3 shadow"></span>
                            ${level} Skills
                        </h3>
                        <div id="projects-${level.toLowerCase()}" class="space-y-1">
                            <!-- Project buttons go here -->
                        </div>
                    `;
                    navGrid.appendChild(levelDiv);

                    // Add project links inside the container
                    const projectsContainer = levelDiv.querySelector(`#projects-${level.toLowerCase()}`);
                    levelData.projects.forEach(project => {
                        const button = document.createElement('button');
                        button.textContent = project.name;
                        button.className = 'project-button text-gray-700 hover:bg-gray-200';
                        
                        // Check for placeholder status
                        const isPlaceholder = project.isPlaceholder || !project.urls.project;
                        if (isPlaceholder) {
                            button.classList.add('disabled-placeholder', 'text-gray-500');
                            button.title = "Content not yet added";
                        }
                        
                        // Store complex data (URLs, skills, and status) as JSON strings/attributes
                        button.dataset.urls = JSON.stringify(project.urls); 
                        button.dataset.name = project.name;
                        button.dataset.skills = JSON.stringify(project.skills); 
                        button.dataset.isPlaceholder = isPlaceholder;

                        // Add click listener
                        button.addEventListener('click', handleProjectClick);
                        projectsContainer.appendChild(button);
                    });
                });
            }

            // Initialize the navigation structure
            generateNavigation();
        });
    </script>
</body>
</html>
