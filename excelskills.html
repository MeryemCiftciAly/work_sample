<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Excel Portfolio</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Tailwind configuration for custom colors (Excel green and blue)
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Light background color for the header
                        'excel-blue': '#f0f2f5', 
                        // Dark green for text and primary accents (Intermediate level)
                        'excel-green': '#107C41',
                        // Custom colors for skill levels
                        'basic-yellow': '#FBBF24', // Yellow 500
                        'adv-orange': '#F97316',   // Orange 600
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <!-- Custom CSS for the essential iframe dimensions and link styles -->
    <style>
        /* Sets the critical height and ensures responsiveness */
        #excel-viewer {
            width: 100%;
            height: 700px; /* Recommended height for spreadsheet viewing */
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            transition: all 0.3s ease-in-out;
        }

        /* Styling for the active link */
        .project-link.active {
            background-color: #107C41; /* excel-green */
            color: white;
            box-shadow: 0 4px 6px rgba(16, 124, 65, 0.4); 
            border-color: #107C41;
        }
        
        /* Specific styling for the project buttons under the new structure */
        .project-button {
            display: block;
            padding: 8px 12px;
            margin-top: 4px;
            font-size: 0.9rem;
            border-radius: 0.375rem;
            transition: background-color 0.2s, transform 0.1s;
            cursor: pointer;
            text-align: left;
        }
        .project-button:hover {
            background-color: #f3f4f6;
            transform: translateY(-1px);
        }
        .project-button.active {
            background-color: #107C41;
            color: white;
            font-weight: 600;
        }

        /* Footer styling */
        .footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid #ddd;
        }
        .footer h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        .footer p {
            margin-bottom: 0.5rem;
            color: #4b5563;
        }
        .footer ul {
            list-style-type: none;
            padding: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 1rem;
        }
        .footer ul li a {
            color: #2874a6;
            font-weight: bold;
            transition: color 0.3s;
        }
        .footer ul li a:hover {
            color: #1e40af;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">

    <!-- Header Section - Contrast fixed and made relative for the absolute home link -->
    <header class="bg-excel-blue text-excel-green text-center p-8 shadow-xl relative">
        <!-- New: Home Link - Made more visible -->
        <a href="https://meryemciftcialy.github.io/work_sample/" target="_self" 
           class="absolute top-4 left-4 sm:top-6 sm:left-6 
                  px-4 py-2 bg-excel-green text-white rounded-lg 
                  text-base font-semibold shadow-lg hover:opacity-90 
                  transition duration-150 flex items-center z-10">
            <span class="text-xl mr-2">&#x2190;</span> Back to Main Site
        </a>
        <h1 class="text-4xl font-bold mb-2"> Interactive Excel Skills Showcase </h1>
        <p class="text-xl opacity-90">Welcome! Select a project below to see an interactive example and the mixed skill set used.</p>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-6xl mx-auto p-4 sm:p-6 lg:p-8 mt-6 bg-white rounded-xl shadow-2xl">
        
        <!-- Under Development Message -->
        <div class="p-4 sm:p-6 mb-8 bg-yellow-50 border-l-4 border-yellow-500 rounded-r-lg shadow-md transition duration-500" role="alert">
            <p class="text-xl font-semibold text-yellow-800 flex items-center">
                <svg class="w-6 h-6 mr-3 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                Section Just Launched Today!
            </p>
            <p class="mt-2 text-gray-700">
                This interactive portfolio is brand new and currently under construction. Actual working Excel sheet embeds demonstrating these skills will be uploaded soon. Please check back later for the live, interactive projects!
            </p>
        </div>

        <hr class="border-gray-300 my-8">

        <!-- Hybrid Table of Contents (TOC) Navigation by Skill Level -->
        <section id="toc" class="mb-8">
            <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Interactive Project Portfolio by Skill Level</h2>
            
            <div id="project-navigation-grid" class="grid md:grid-cols-3 gap-6">
                <!-- Navigation links will be dynamically injected here by the script -->
            </div>
        </section>

        <hr class="border-gray-300 my-8">

        <!-- Project View Area (where the spreadsheet embeds and skills are listed) -->
        <section id="project-display">
            
            <!-- Skills Breakdown Section -->
            <div id="skills-breakdown" class="p-4 bg-gray-100 rounded-lg shadow-inner mb-6 transition duration-300 ease-in-out hidden">
                <h3 class="text-xl font-bold text-gray-700 mb-3 border-b pb-2">Skills Demonstrated in Project: <span id="project-title-display" class="text-excel-green"></span></h3>
                <h4 class="text-lg font-semibold text-gray-600 mb-2">Mixed Formulas and Techniques Used:</h4>
                <div id="skills-list" class="flex flex-wrap gap-2">
                    <!-- Skills will be dynamically injected here -->
                </div>
            </div>

            <!-- Single IFRAME Container -->
            <div class="excel-embed-container rounded-xl overflow-hidden shadow-xl">
                <!-- Initial Message -->
                <p id="initial-message" class="text-center p-12 text-lg text-gray-500 border-2 border-dashed border-gray-300 rounded-xl bg-gray-50 transition duration-500 block">
                    Please select a project from the navigation above to load and interact with the Excel project.
                </p>
                <!-- The single IFRAME element that will have its source dynamically updated -->
                <iframe id="excel-viewer" src="" allowfullscreen class="hidden"></iframe>
            </div>
        </section>
    </main>

    <!-- Footer Section -->
    <div class="footer">
        <h2>ðŸ“¬ Contact Me</h2>
        <p>Feel free to reach out if youâ€™d like a copy of my resume or just want to connect!</p>
        <ul>
            <li><a href="mailto:meryemkciftci@gmail.com">Email</a></li>
            <li><a href="https://linkedin.com/in/meryack" target="_blank">LinkedIn</a></li>
            <li><a href="https://meryemciftcialy.github.io/work_sample/about_me.html">About Me</a></li>
        </ul>
        <p class="note text-sm text-excel-green font-semibold">Currently open to work opportunities.</p>
        <p class="note2 text-xs text-gray-400">Last updated: September 2025. Check back for new additions!</p>
    </div>


    <!-- JavaScript for Interactivity and Dynamic Content Generation -->
    <script>
        const projectData = {
            'Basic': {
                color: 'basic-yellow',
                projects: [
                    { name: "Project 1: Sales Data Entry Form", url: "https://onedrive.live.com/embed?resid=...&wdAllowInteractivity=True&embed=1", skills: ["Data Validation (Lists)", "Basic Formulas (+, -, *, /)", "Conditional Formatting", "Absolute References ($)"] },
                    { name: "Project 2: Monthly Budget Tracker", url: "https://onedrive.live.com/embed?resid=...&wdAllowInteractivity=True&embed=2", skills: ["SUM/AVERAGE/MIN/MAX", "Basic Charts (Line/Bar)", "Freeze Panes", "Number Formatting"] },
                ]
            },
            'Intermediate': {
                color: 'excel-green',
                projects: [
                    { name: "Project 3: Inventory Management", url: "https://onedrive.live.com/embed?resid=...&wdAllowInteractivity=True&embed=3", skills: ["XLOOKUP (Single Lookup)", "Pivot Tables & Charts", "Slicers", "IF/IFS/AND/OR Functions"] },
                    { name: "Project 4: HR Payroll Calculator", url: "https://onedrive.live.com/embed?resid=...&wdAllowInteractivity=True&embed=4", skills: ["VLOOKUP (Legacy Method)", "SUMIFS/COUNTIFS", "Data Aggregation", "Named Ranges"] },
                ]
            },
            'Advanced': {
                color: 'adv-orange',
                projects: [
                    { name: "Project 5: Financial Model Template", url: "https://onedrive.live.com/embed?resid=...&wdAllowInteractivity=True&embed=5", skills: ["INDEX/MATCH/MATCH (Triple)", "Dynamic Array Formulas (FILTER)", "Scenario Manager (Concept)", "OFFSET/INDIRECT Functions"] },
                    { name: "Project 6: Automated Report Prep", url: "https://onedrive.live.com/embed?resid=...&wdAllowInteractivity=True&embed=6", skills: ["VBA/Macros (Basic Recording & Editing)", "Power Query (Basic Get & Transform)", "Text Manipulation (LEFT, RIGHT, FIND)", "Complex Nesting"] },
                ]
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            const excelViewer = document.getElementById('excel-viewer');
            const initialMessage = document.getElementById('initial-message');
            const navGrid = document.getElementById('project-navigation-grid');
            const skillsBreakdown = document.getElementById('skills-breakdown');
            const skillsList = document.getElementById('skills-list');
            const projectTitleDisplay = document.getElementById('project-title-display');

            /**
             * Dynamically generates the navigation structure based on projectData.
             */
            function generateNavigation() {
                navGrid.innerHTML = ''; // Clear existing content

                Object.keys(projectData).forEach(level => {
                    const levelData = projectData[level];
                    const levelColor = levelData.color;
                    
                    // Create the level container
                    const levelDiv = document.createElement('div');
                    levelDiv.className = `p-4 rounded-xl shadow-lg border border-gray-200 bg-${levelColor.replace('-500', '-100/50').replace('-600', '-100/50')}`;
                    
                    // Level Header with colored circle
                    levelDiv.innerHTML = `
                        <h3 class="text-xl font-bold mb-4 flex items-center text-gray-800">
                            <span class="w-4 h-4 rounded-full bg-${levelColor} mr-3 shadow"></span>
                            ${level} Skills
                        </h3>
                        <div id="projects-${level.toLowerCase()}" class="space-y-1">
                            <!-- Project buttons go here -->
                        </div>
                    `;
                    navGrid.appendChild(levelDiv);

                    // Add project links inside the container
                    const projectsContainer = levelDiv.querySelector(`#projects-${level.toLowerCase()}`);
                    levelData.projects.forEach(project => {
                        const button = document.createElement('button');
                        button.textContent = project.name;
                        button.className = 'project-button text-gray-700 hover:bg-gray-200';
                        button.dataset.url = project.url;
                        button.dataset.name = project.name;
                        button.dataset.skills = JSON.stringify(project.skills); // Store skills as JSON string

                        // Add click listener
                        button.addEventListener('click', handleProjectClick);
                        projectsContainer.appendChild(button);
                    });
                });
            }

            /**
             * Handles the click event on a project button.
             */
            function handleProjectClick(event) {
                event.preventDefault();

                // 1. Get data from the button
                const button = event.currentTarget;
                const newUrl = button.dataset.url;
                const projectName = button.dataset.name;
                const skills = JSON.parse(button.dataset.skills);

                // 2. Update IFRAME source and visibility
                excelViewer.src = newUrl;
                initialMessage.classList.add('hidden');
                excelViewer.classList.remove('hidden');

                // 3. Highlight the active link
                document.querySelectorAll('.project-button').forEach(btn => {
                    btn.classList.remove('active');
                    btn.classList.remove('text-white');
                    btn.classList.add('text-gray-700');
                });
                button.classList.add('active');
                button.classList.remove('text-gray-700');
                button.classList.add('text-white');
                
                // 4. Update Skills Breakdown Section
                projectTitleDisplay.textContent = projectName;
                skillsList.innerHTML = ''; // Clear previous skills

                skills.forEach(skill => {
                    const skillTag = document.createElement('span');
                    skillTag.textContent = skill;
                    // Tag styling
                    skillTag.className = 'px-3 py-1 bg-excel-green text-white text-sm font-medium rounded-full shadow-sm';
                    skillsList.appendChild(skillTag);
                });

                skillsBreakdown.classList.remove('hidden'); // Show the skills section

                // 5. Optional: Scroll down to the project view section for better UX on mobile
                document.getElementById('project-display').scrollIntoView({ behavior: 'smooth' });
            }

            // Initialize the navigation structure
            generateNavigation();
        });
    </script>
</body>
</html>
